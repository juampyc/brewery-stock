<!DOCTYPE html>
<html lang="es" data-theme="light">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Castelo | Producción y Empaquetado</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <script>window.APP_VER = "20250910j";</script>
  <!-- libs -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" defer></script>
  <!-- loader -->
  <script src="./js/app-loader.js?v=1" defer></script>
</head>
<body>
  <header class="border-bottom bg-body px-3 py-2 d-flex justify-content-between align-items-center">
    <div class="d-flex align-items-center gap-2">
      <span class="fw-bold">Castelo</span>
      <a class="btn btn-link p-0" href="index.html">Inicio</a>
      <a class="btn btn-link p-0" href="config.html">Configuración</a>
      <a class="btn btn-link p-0" href="labels.html">Etiquetas</a>
      <a class="btn btn-link p-0" href="movements.html">Movimientos</a>
      <a class="btn btn-link p-0 fw-semibold" href="packaging.html">Producción & Empaquetado</a>
    </div>
    <div class="form-check form-switch m-0">
      <input class="form-check-input" type="checkbox" id="themeSwitch" />
      <label class="form-check-label" for="themeSwitch">Dark</label>
    </div>
  </header>

  <main class="container py-3">
    <h1 class="h4 mb-3">Producción & Empaquetado</h1>

    <!-- Tabs -->
    <ul class="nav nav-tabs" id="pkg_tabs" role="tablist">
      <li class="nav-item" role="presentation">
        <button class="nav-link active" id="tab-produce" data-bs-toggle="tab" data-bs-target="#pane-produce" type="button" role="tab">Producir</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="tab-package" data-bs-toggle="tab" data-bs-target="#pane-package" type="button" role="tab">Empaquetar</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="tab-boxes" data-bs-toggle="tab" data-bs-target="#pane-boxes" type="button" role="tab">Cajas (ingreso)</button>
      </li>
      <li class="nav-item ms-auto d-none d-md-block">
        <span class="nav-link disabled">Vacías: <b id="ec_stock">—</b> | Cajas12: <b id="bx12_stock">—</b> | Cajas24: <b id="bx24_stock">—</b></span>
      </li>
    </ul>

    <div class="tab-content mt-3">
      <!-- PRODUCIR -->
      <div class="tab-pane fade show active" id="pane-produce" role="tabpanel">
        <div class="card">
          <div class="card-body">
            <div class="row g-3 align-items-end">
              <div class="col-md-4">
                <label class="form-label mb-1">Estilo</label>
                <select id="prod_style" class="form-select"></select>
              </div>
              <div class="col-md-3">
                <label class="form-label mb-1">Envase</label>
                <select id="prod_container" class="form-select"></select>
                <div class="form-text">Stock vacías: <span id="prod_ec_avail">—</span></div>
              </div>
              <div class="col-md-2">
                <label class="form-label mb-1">Cantidad (latas)</label>
                <input id="prod_qty" type="number" class="form-control" min="1" value="12" />
              </div>
              <div class="col-md-3">
                <label class="form-label mb-1">Fecha y hora</label>
                <input id="prod_dt" type="datetime-local" class="form-control" />
              </div>
            </div>

            <div class="row g-3 mt-1 align-items-center">
              <div class="col-md-3">
                <div class="form-check mt-2">
                  <input class="form-check-input" type="checkbox" id="prod_pasteurized">
                  <label class="form-check-label" for="prod_pasteurized">Pasteurizada</label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" id="prod_labeled">
                  <label class="form-check-label" for="prod_labeled">Etiquetada</label>
                </div>
              </div>
              <div class="col-md-5">
                <label class="form-label mb-1">Etiqueta</label>
                <select id="prod_label" class="form-select"></select>
                <div class="form-text">Disponibles: <span id="prod_lbl_avail">—</span></div>
              </div>
              <div class="col-md-4 text-end">
                <button id="prod_submit" class="btn btn-primary">Registrar producción</button>
              </div>
            </div>
          </div>
        </div>

        <div class="row g-3 mt-3">
          <div class="col-md-6">
            <div class="card"><div class="card-body">
              <h6 class="card-title mb-2">Stock de latas por estado</h6>
              <div class="table-responsive">
                <table class="table table-sm mb-0">
                  <thead><tr><th>Estilo</th><th>Estado</th><th>Etiqueta</th><th class="text-end">Qty</th></tr></thead>
                  <tbody id="stock_cans_tbody"></tbody>
                </table>
              </div>
            </div></div>
          </div>
          <div class="col-md-6">
            <div class="card"><div class="card-body">
              <h6 class="card-title mb-2">Paquetes armados</h6>
              <div class="table-responsive">
                <table class="table table-sm mb-0">
                  <thead><tr><th>Estilo</th><th>Etiqueta</th><th>Tipo</th><th class="text-end">Cajas</th><th class="text-end">Latas</th></tr></thead>
                  <tbody id="stock_pk_tbody"></tbody>
                </table>
              </div>
            </div></div>
          </div>
        </div>
      </div>

      <!-- EMPAQUETAR -->
      <div class="tab-pane fade" id="pane-package" role="tabpanel">
        <div class="card">
          <div class="card-body">
            <div class="row g-3 align-items-end">
              <div class="col-md-4">
                <label class="form-label mb-1">Estilo</label>
                <select id="pack_style" class="form-select"></select>
                <div class="form-text">Stock disponible (filtro): <span id="pack_avail">—</span></div>
              </div>
              <div class="col-md-3">
                <label class="form-label mb-1">Estado</label>
                <select id="pack_state" class="form-select">
                  <option value="">— Cualquiera —</option>
                  <option value="final">final</option>
                  <option value="sin_pasteurizar_sin_etiquetar">sin_pasteurizar_sin_etiquetar</option>
                  <option value="sin_pasteurizar_etiquetada">sin_pasteurizar_etiquetada</option>
                  <option value="pasteurizada_sin_etiquetar">pasteurizada_sin_etiquetar</option>
                </select>
              </div>
              <div class="col-md-3">
                <label class="form-label mb-1">Etiqueta (opcional)</label>
                <select id="pack_label" class="form-select"></select>
              </div>
              <div class="col-md-2">
                <label class="form-label mb-1">Fecha y hora</label>
                <input id="pack_dt" type="datetime-local" class="form-control" />
              </div>
            </div>

            <div class="row g-3 mt-1 align-items-end">
              <div class="col-md-3">
                <label class="form-label mb-1">Tipo de caja</label>
                <select id="pack_type" class="form-select">
                  <option value="box12">Caja x12</option>
                  <option value="box24">Caja x24</option>
                </select>
                <div class="form-text">Cajas disponibles: <span id="pack_boxes_avail">—</span></div>
              </div>
              <div class="col-md-3">
                <label class="form-label mb-1">Cajas a armar</label>
                <input id="pack_boxes" type="number" class="form-control" min="1" value="1" />
              </div>
              <div class="col-md-3">
                <label class="form-label mb-1">Latas totales</label>
                <input id="pack_units" type="number" class="form-control" disabled />
              </div>
              <div class="col-md-3 text-end">
                <button id="pack_submit" class="btn btn-primary">Armar paquetes</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- CAJAS (INGRESO) -->
      <div class="tab-pane fade" id="pane-boxes" role="tabpanel">
        <div class="card">
          <div class="card-body">
            <div class="row g-3 align-items-end">
              <div class="col-md-3">
                <label class="form-label mb-1">Tipo de caja</label>
                <select id="bx_type" class="form-select">
                  <option value="box12">Caja x12</option>
                  <option value="box24">Caja x24</option>
                </select>
              </div>
              <div class="col-md-3">
                <label class="form-label mb-1">Cantidad (cajas)</label>
                <input id="bx_qty" type="number" class="form-control" min="1" value="5" />
              </div>
              <div class="col-md-3">
                <label class="form-label mb-1">Fecha y hora</label>
                <input id="bx_dt" type="datetime-local" class="form-control" />
              </div>
              <div class="col-md-3 text-end">
                <button id="bx_submit" class="btn btn-outline-primary">Ingresar cajas</button>
              </div>
            </div>
          </div>
        </div>

        <div class="card mt-3">
          <div class="card-body">
            <h6 class="card-title mb-2">Stock de cajas vacías</h6>
            <div class="table-responsive">
              <table class="table table-sm mb-0">
                <thead><tr><th>Tipo</th><th class="text-end">Cajas</th></tr></thead>
                <tbody id="stock_boxes_tbody"></tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</body>
</html>
